<section #consumer_appointmentbill class="container p-0 confirm-aptckn no-padding-small">
    <div class="content p0 comn-cls cons-check-bill">
        <div class="col-md-12 no-padding">
            <div class="w-dta">
                <div class="row" *ngIf="invoiceDetailsById">
                    <div class="c-outer m0">
                        <div class="c-body">
                            <div class="card title-gb pointer-cursor">
                                <h5 *ngIf="(invoiceDetailsById && invoiceDetailsById.amountDue != 0)" class="mt-2">Invoice <a
                                        class="pull-left me-4 back-btn" (click)="goBack()"><i
                                            class="fa fa-arrow-left"></i></a></h5>
                                <h5 *ngIf="(invoiceDetailsById && invoiceDetailsById.amountDue == 0)" class="mt-2">Invoice<a
                                        class="pull-left me-4 back-btn" (click)="goBack()"><i
                                            class="fa fa-arrow-left"></i></a></h5>
                            </div>
                            <div class="copy one">
                                <div class="col-a ps-0 col-md-12 col-lg-12 col-xl-12 col-sm-12 col-12">
                                    <div class="card bill-section">
                                        <div class="bill-section-content">
                                            <div class="col-md-12 col-sm-12 col-lg-12 bill-wrapper viewBill no-padding-small"
                                                *ngIf="invoiceDetailsById">
                                                <!-- <div class="global-icons col-md-12 col-sm-12 col-lg-12">
                                                    <button (click)="printMe()" [matTooltipClass]="tooltipcls"
                                                        [matTooltip]="'Print'" id="btnPrint">
                                                        <i class="fa fa-print" aria-hidden="true"></i>
                                                    </button>
                                                </div> -->
                                                <div id="receipt" class="receipt">
                                                    <div class="bill-header mgn-up-50" *ngIf="!showPaidlist">
                                                       
                                                        <div class="section-one" *ngIf="splocation">
                                                            <div class="pro-logo1 " *ngIf="logo">
                                                                <img src="{{logo}}" width="80px" height="80px" >
                                        
                                                            </div>
                                                          <div class="bname1"><h3>{{bname | capitalizeFirst}}</h3></div>

                                                            <span
                                                                style="display:flex;justify-content: center;">{{splocation}}
                                                                <span class="icon-location"></span>
                                                            </span>
                                                            <br><br><br>
                                                            <!---bill details start-->
                                                            <div style="display: flex;justify-content: space-between;">
                                                                <div>
                                                                    <div *ngIf="invoiceDetailsById.providerConsumerData">
                                                                        <div>
                                                                            <span *ngIf="invoiceDetailsById.providerConsumerData.firstName">{{invoiceDetailsById.providerConsumerData.firstName | capitalizeFirst}}</span>&nbsp;
                                                                            <span *ngIf="invoiceDetailsById.providerConsumerData.lastName">{{invoiceDetailsById.providerConsumerData.lastName | capitalizeFirst}}</span>
                                                                           
                                                                        </div>

                                                                    </div>
                                                                    <div *ngIf="billnumber" style="display: flex;
                                                                        justify-content: start;
                                                                        gap: 5px;">
                                                                        <div>Invoice #</div>
                                                                        <div>{{billnumber}}</div>

                                                                    </div>

                                                                </div>
                                                                <div>
                                                                    <div *ngIf="gstnumber">
                                                                        <div>
                                                                            {{gstin_cap}} :
                                                                            {{gstnumber
                                                                            |
                                                                            capitalizeFirst}}
                                                                        </div>
                                                                    </div>
                                                                    <div *ngIf="billdate">Invoice Date :
                                                                        {{billdate
                                                                        | date:newDateFormat_date}}
                                                                        <!-- {{billtime}} &nbsp; -->
                                                                    </div>
                                                                    <div *ngIf="dueDate">Due Date :
                                                                        {{dueDate
                                                                        | date:newDateFormat_date}}
                                                                        <!-- {{billtime}} &nbsp; -->
                                                                    </div>

                                                                </div>
                                                            </div>

                                                            <!---bill details end-->

                                                            <span class="columns mt-2" *ngIf="invoiceDetailsById.providerData">
                                                                <span class="dynamic">{{provider_label
                                                                    |
                                                                    capitalizeFirst}} : </span>
                                                                <span class="dynamic">
                                                                    {{(invoiceDetailsById.providerData.businessName) ?
                                                                        invoiceDetailsById.providerData.businessName :
                                                                        invoiceDetailsById.providerData.firstName
                                                                    + ' ' + invoiceDetailsById.providerData.lastName}}
                                                                </span>
                                                            </span>

                                                            <div class="col-md-12 col-sm-12 col-lg-12 p-0 red"
                                                                *ngIf="invoiceDetailsById.billStatus == 'Cancel'">
                                                                Cancelled</div>
                                                                <div class="col-md-12 col-sm-12 col-lg-12 p-0 green"
                                                                *ngIf="invoiceDetailsById.billStatus == 'Settled'">
                                                                Settled</div>


                                                        </div>
                                                    </div>
                                                    <app-common-innerloading-spinner *ngIf="loadingPaytm">
                                                    </app-common-innerloading-spinner>
                                                    <div class="bill-content">
                                                        <div class="section-three bill-responsive no-padding-small">
                                                            <div class="bill-breakup">
                                                                <div class="list"
                                                                    *ngFor="let service of invoiceDetailsById.serviceList; let i = index">
                                                                    <div class="list-content">
                                                                        <div class="c-row one servlist">
                                                                            <div class="name">
                                                                                {{service.serviceName |
                                                                                capitalizeFirst}}
                                                                                <span class="rupee-font">{{service.price
                                                                                    | currency:'&#8377;
                                                                                    '}}</span>
                                                                                <span [matTooltipClass]="tooltipcls"
                                                                                    [matTooltip]="'Taxable'"
                                                                                    *ngIf="service.GSTpercentage > 0"><sup>Tax</sup></span>
                                                                            </div>
                                                                            <div class="quantity">
                                                                                {{qnty_cap}}
                                                                                {{service.quantity}}</div>
                                                                            <div class="price rupee-font">
                                                                                {{(service.quantity *
                                                                                service.price) |
                                                                                currency:'&#8377; '}}</div>
                                                                        </div>
                                                                        <div class="c-row two section-two">
                                                                            <div class="discount-row two-col"
                                                                                *ngFor="let discount of service.discount">
                                                                                <div class="name">
                                                                                    {{discount.name}}</div>
                                                                                <div class="price rupee-font">
                                                                                    (-){{discount.discountValue
                                                                                    |
                                                                                    currency:'&#8377; '}}</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row one three two-col"
                                                                            *ngIf="service.discount &&service.discount.length > 0">
                                                                            <div class="name">
                                                                                {{sub_tot_cap}}
                                                                            </div>
                                                                            <div class="price rupee-font">
                                                                                {{service.netRate |
                                                                                currency:'&#8377; '}}</div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="list"
                                                                    *ngFor="let item of invoiceDetailsById.itemList; let i = index">
                                                                    <div class="list-content">
                                                                        <div class="c-row one servlist">
                                                                            <div class="name">
                                                                                {{item.itemName |
                                                                                capitalizeFirst}}
                                                                                <span class="rupee-font">{{item.price
                                                                                    |
                                                                                    currency:'&#8377; '}}</span>
                                                                                <span [matTooltipClass]="tooltipcls"
                                                                                    [matTooltip]="'Taxable'"
                                                                                    *ngIf="item.GSTpercentage > 0"><sup>Tax</sup></span>
                                                                            </div>
                                                                            <div class="quantity">{{qnty_cap}}
                                                                                {{item.quantity}}</div>
                                                                            <div class="price rupee-font">
                                                                                {{(item.quantity * item.price) |
                                                                                currency:'&#8377; '}}</div>
                                                                        </div>
                                                                        <div class="c-row two section-two" *ngIf="item.discount && item.discount.length > 0">
                                                                            <div class="discount-row two-col"
                                                                                *ngFor="let discount of item.discount">
                                                                                <div class="name">
                                                                                    {{discount.name}}</div>
                                                                                <div class="price rupee-font">
                                                                                    (-){{discount.discountValue
                                                                                    |
                                                                                    currency:'&#8377; '}}</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row one three two-col"
                                                                            *ngIf="item.discount && item.discount.length > 0">
                                                                            <div class="name">
                                                                                {{sub_tot_cap}}
                                                                            </div>
                                                                            <div class="price rupee-font">
                                                                                {{item.netRate |
                                                                                currency:'&#8377; '}}</div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="list"
                                                                *ngFor="let item of invoiceDetailsById.adhocItemList; let i = index">
                                                                <div class="list-content">
                                                                    <div class="c-row one servlist">
                                                                        <div class="name">
                                                                            {{item.itemName |
                                                                            capitalizeFirst}}
                                                                            <span class="rupee-font">{{item.price
                                                                                | currency:'&#8377;
                                                                                '}}</span>
                                                                            <span [matTooltipClass]="tooltipcls"
                                                                                [matTooltip]="'Taxable'"
                                                                                *ngIf="item.GSTpercentage > 0"><sup>Tax</sup></span>
                                                                        </div>
                                                                        <div class="quantity">
                                                                            {{qnty_cap}}
                                                                            {{item.quantity}}</div>
                                                                        <div class="price rupee-font">
                                                                            {{(item.quantity *
                                                                                item.price) |
                                                                            currency:'&#8377; '}}</div>
                                                                    </div>
                                                                  
                                                                </div>
                                                            </div>
                                                                <div class="list bill-summary">
                                                                    <div class="list-content">
                                                                        <div class="c-row one two-col">
                                                                            <div class="name">
                                                                                {{gross_amnt_cap}}
                                                                            </div>
                                                                            <div class="price rupee-font">
                                                                                {{invoiceDetailsById.netTotal |
                                                                                currency:'&#8377; '}}
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row two section-two">
                                                                            <div class="discount-row two-col"
                                                                                *ngIf="invoiceDetailsById.jdn && invoiceDetailsById.jdn.discount">
                                                                                <div class="name">JDN</div>
                                                                                <div class="price rupee-font">
                                                                                    (-){{invoiceDetailsById.jdn.discount
                                                                                    |
                                                                                    currency:'&#8377; '}}</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row two section-two"
                                                                            *ngFor="let discount of invoiceDetailsById.discounts">
                                                                            <div class="discount-row two-col">
                                                                                <div class="name">
                                                                                    {{discount.name}}
                                                                                </div>
                                                                                <div class="price rupee-font">
                                                                                    (-){{discount.discountValue |
                                                                                    currency:'&#8377; '}}</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row two section-two"
                                                                            *ngFor="let coupon of invoiceDetailsById.providerCoupons">
                                                                            <div class="discount-row two-col">
                                                                                <div class="name">
                                                                                    {{coupon.couponCode}}
                                                                                </div>
                                                                                <div class="price rupee-font">
                                                                                    <span>(-)</span>
                                                                                    <span
                                                                                        (click)="showJCCouponNote(coupon)"
                                                                                        [class.couponAmt]="coupon.discount">{{coupon.discount
                                                                                        |
                                                                                        currency:'&#8377;
                                                                                        '}}</span>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row two section-two"
                                                                            *ngFor="let jcoupon of invoiceDetailsById.jaldeeCoupons">
                                                                            <div class="discount-row two-col">
                                                                                <div class="name">
                                                                                    {{jcoupon.couponCode}}
                                                                                </div>
                                                                                <div class="price rupee-font">
                                                                                    <span>(-)</span>
                                                                                    <span
                                                                                        (click)="showJCCouponNote(jcoupon)"
                                                                                        [class.couponAmt]="jcoupon.discount">{{jcoupon.value.value
                                                                                        |
                                                                                        currency:'&#8377;
                                                                                        '}}</span>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row two section-two"
                                                                            *ngIf="invoiceDetailsById.taxableTotal">
                                                                            <div class="discount-row two-col">
                                                                                <div class="name">
                                                                                    <span class="tax-top">Tax
                                                                                        <span
                                                                                            class="rupee-font">{{invoiceDetailsById.taxPercentage}}%
                                                                                            of
                                                                                            {{invoiceDetailsById.taxableTotal
                                                                                            |
                                                                                            currency:'&#8377;
                                                                                            '}}</span>
                                                                                    </span><br /><span
                                                                                        class="txn">(CGST-{{invoiceDetailsById.taxPercentage/2}}%,
                                                                                        SGST-{{invoiceDetailsById.taxPercentage/2}}%)</span>
                                                                                </div>
                                                                                <div class="price rupee-font">
                                                                                    (+){{invoiceDetailsById.netTaxAmount
                                                                                    |
                                                                                    currency:'&#8377; '}}</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row one two-col"
                                                                            *ngIf="invoiceDetailsById.netRate > 0">
                                                                            <div class="name">
                                                                                Net Total
                                                                            </div>
                                                                            <div class="price rupee-font">
                                                                                {{invoiceDetailsById.netRate |
                                                                                currency:'&#8377; '}}</div>
                                                                        </div>
                                                                        <div class="c-row two section-two"
                                                                            *ngIf="invoiceDetailsById.customerPaidCharges > 0">
                                                                            <div class="discount-row two-col">
                                                                                <div class="name">
                                                                                    Processing Fee
                                                                                </div>
                                                                                <div class="price rupee-font">
                                                                                    {{invoiceDetailsById.customerPaidCharges
                                                                                    |
                                                                                    currency:'&#8377; '}}</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row two section-two"
                                                                            *ngIf="invoiceDetailsById.amountPaid > 0">
                                                                            <div class="discount-row two-col">
                                                                                <div class="name">
                                                                                    Amount Paid
                                                                                </div>
                                                                                <div class="price rupee-font">
                                                                                    {{invoiceDetailsById.amountPaid
                                                                                    |
                                                                                    currency:'&#8377; '}}</div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row one two-col"
                                                                            *ngIf="invoiceDetailsById.amountDue >= 0">
                                                                            <div class="name">
                                                                                Amount Due
                                                                            </div>
                                                                            <div class="price rupee-font">
                                                                                {{checkJcash ?
                                                                                ((invoiceDetailsById.amountDue -
                                                                                jcashamount) |
                                                                                currency:'&#8377;' ):
                                                                                (invoiceDetailsById.amountDue |
                                                                                currency:'&#8377;') }}
                                                                            </div>
                                                                        </div>
                                                                        <div class="c-row one two-col"
                                                                            *ngIf="invoiceDetailsById.amountDue < 0">
                                                                            <div class="name">Refundable Amount
                                                                            </div>
                                                                            <div class="price rupee-font">
                                                                                {{refund_value |
                                                                                currency:'&#8377; '}}</div>
                                                                        </div>
                                                                        <div class="c-row one two-col"
                                                                            *ngIf="invoiceDetailsById.refundedAmount > 0">
                                                                            <div class="name">Amount Refunded
                                                                            </div>
                                                                            <div class="price rupee-font">
                                                                                {{invoiceDetailsById.refundedAmount |
                                                                                currency:'&#8377; '}}</div>
                                                                        </div>
                                                                        <div class="amountSaved"
                                                                            *ngIf="invoiceDetailsById.totalAmountSaved > 0 && invoiceDetailsById.billPaymentStatus != 'FullyPaid'">
                                                                            <div class="price rupee-font"> You
                                                                                will save
                                                                                {{invoiceDetailsById.totalAmountSaved |
                                                                                currency:'&#8377;'}}
                                                                            </div>
                                                                        </div>
                                                                        <div class="amountSaved"
                                                                            *ngIf="invoiceDetailsById.totalAmountSaved > 0 && invoiceDetailsById.billPaymentStatus == 'FullyPaid'">
                                                                            <div class="price rupee-font"> You
                                                                                have saved
                                                                                {{invoiceDetailsById.totalAmountSaved |
                                                                                currency:'&#8377;'}}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="section-three no-padding-small"
                                                            *ngIf="invoiceDetailsById && billNoteExists">
                                                            <a class="learnmore-pointer" id="customer-help"
                                                                (click)="billNotesClicked()">Invoice notes</a>
                                                            <div class="bill-notes"
                                                                *ngIf="showBillNotes && billNoteExists">
                                                                <ul>
                                                                    <li *ngIf="invoiceDetailsById.displayNotes">
                                                                        {{invoiceDetailsById.displayNotes.displayNotes}}
                                                                    </li>
                                                                    <div class
                                                                        *ngFor="let discount of invoiceDetailsById.discounts">
                                                                        <li *ngIf="discount.displayNote">
                                                                            <span style="font-weight: 600">
                                                                                {{discount.name}} -
                                                                            </span>
                                                                            {{discount.displayNote}}
                                                                        </li>
                                                                    </div>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                               
                                            </div>
                                            <div *ngIf="paidStatus == 'true'">
                                                <i class="fa fa-check-circle" style="color: green;"><span
                                                        style="font-size: large;">Paid Successfully</span>
                                                </i><br><br>
                                                <div class="ivc">
                                                    <div class="pay-det-row">
                                                        <span><b>Payment Gateway:</b>
                                                            <span>{{this.pGateway}}</span></span>
                                                    </div>
                                                    <div class="pay-det-row">
                                                        <span><b> Payment Ref Id:</b>
                                                            <span>{{razorpay_payment_id}}</span></span>
                                                    </div>
                                                    <div class="pay-det-row">
                                                        <span><b> Transaction Id:</b>
                                                            <span>{{razorpay_order_id}}</span></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
